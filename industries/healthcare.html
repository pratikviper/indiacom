<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Healthcare Industry - Indiacom</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
  <script src="../js/testimonials.js" defer></script>
  <script src="../js/include.js" defer></script><!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-SRCDCRBLTV"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-SRCDCRBLTV');
</script>
  <style>
  @keyframes fadeInUp {
    from { opacity: 0; transform: translateY(20px); }
    to   { opacity: 1; transform: translateY(0); }
  }
  .fade-in-up { animation: fadeInUp 0.9s ease-out both; }
  .company-card { transition: all 0.3s ease; }
  .company-card:hover { transform: translateY(-5px); }

  /* NEW: hero background */
  .hero-healthcare {
      background-image: url('../assets/healthcare.jpg'); /* default guess; JS below will auto-fix if path differs */
      background-size: cover;
      background-position: center;
    }
</style>
</head>

<body class="min-h-screen flex flex-col bg-white text-gray-800">
  <div data-include="../components/navbar.html"></div>

  <!-- Hero Section -->
  <section class="relative text-center py-20 px-6 text-white hero-healthcare">
    <!-- Use Tailwind v4 color+opacity syntax to avoid fully opaque overlay -->
    <div class="absolute inset-0 bg-black/50"></div>
    <div class="relative z-10 max-w-4xl mx-auto">
      <h1 class="text-4xl md:text-5xl font-bold mb-6 fade-in-up">Healthcare & Wellness</h1>
      <p class="text-lg md:text-xl mb-4 fade-in-up">
        Discover healthcare companies we've helped enhance their online presence
      </p>
      <p class="text-blue-100 text-sm fade-in-up">
        Medical centers, clinics, hospitals, and healthcare providers
      </p>
    </div>
  </section>

  <!-- Companies Grid -->
  <section class="py-20 px-6 bg-gray-50">
    <div class="max-w-7xl mx-auto">
      <h2 class="text-3xl font-bold text-center mb-12 text-gray-800">Healthcare & Wellness</h2>

      <div class="flex justify-center mb-8">
        <div class="inline-flex rounded-lg border bg-white overflow-hidden shadow" role="tablist"
          aria-label="Video type">
          <button id="switch-youtube" class="px-4 py-2 text-sm font-medium bg-gray-900 text-white focus:outline-none"
            role="tab" aria-selected="true">
            YouTube
          </button>
          <button id="switch-virtual"
            class="px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-100 focus:outline-none" role="tab"
            aria-selected="false">
            Virtual Tour
          </button>
        </div>
      </div>
      
      <div id="companies-grid" class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
        <!-- Companies will be populated by JavaScript -->
      </div>

      <!-- Loading State -->
      <div id="loading-state" class="text-center py-12">
        <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-900"></div>
        <p class="mt-4 text-gray-600">Loading healthcare companies...</p>
      </div>

      <!-- No Results State -->
      <div id="no-results" class="text-center py-12 hidden">
        <div class="text-6xl mb-4">üè•</div>
        <p class="text-gray-600 text-lg">No healthcare companies found.</p>
      </div>
    </div>
  </section>

  <!-- Back to Industries -->
  <section class="py-12 px-6 bg-white">
    <div class="max-w-4xl mx-auto text-center">
      <a href="../index.html#industries-we-serve" class="inline-flex items-center px-6 py-3 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 transition-colors">
        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
        </svg>
        Back to Industries
      </a>
    </div>
  </section>

  <div data-include="../components/footer.html" class="mt-auto"></div>

<script>
  let viewMode = 'youtube'; // 'youtube' | 'virtual'

  // Strictly read only the exact 'virtualtourURL' key (case-insensitive)
  function getTourUrl(obj) {
    if (!obj) return null;
    const key = Object.keys(obj).find(k => k.toLowerCase() === 'virtualtoururl');
    const url = key ? obj[key] : null;
    return (typeof url === 'string' && url.trim()) ? url.trim() : null;
  }

  // Strictly read only the exact 'youtubeVideoURL' key (case-insensitive)
  function getYouTubeUrl(obj) {
    if (!obj) return null;
    const key = Object.keys(obj).find(k => k.toLowerCase() === 'youtubevideourl');
    const url = key ? obj[key] : null;
    return (typeof url === 'string' && url.trim()) ? url.trim() : null;
  }

  // Convert any common YouTube URL to an embeddable form
  function toYouTubeEmbed(url) {
    if (!url) return null;
    try {
      const u = new URL(url);
      const host = u.hostname.replace(/^www\./, '');

      // https://youtu.be/VIDEO_ID
      if (host === 'youtu.be') {
        const id = u.pathname.slice(1);
        if (!id) return null;
        const start = (u.searchParams.get('t') || u.searchParams.get('start') || '').replace(/[^\d]/g, '');
        return `https://www.youtube.com/embed/${id}${start ? `?start=${start}` : ''}`;
      }

      // youtube.com/* variants
      if (host === 'youtube.com' || host === 'm.youtube.com') {
        // /watch?v=VIDEO_ID
        if (u.pathname === '/watch' && u.searchParams.get('v')) {
          const id = u.searchParams.get('v');
          const start = (u.searchParams.get('t') || u.searchParams.get('start') || '').replace(/[^\d]/g, '');
          return `https://www.youtube.com/embed/${id}${start ? `?start=${start}` : ''}`;
        }
        // /shorts/VIDEO_ID
        if (u.pathname.startsWith('/shorts/')) {
          const id = u.pathname.split('/')[2];
          return id ? `https://www.youtube.com/embed/${id}` : null;
        }
        // already /embed/VIDEO_ID
        if (u.pathname.startsWith('/embed/')) return url;
      }

      return url; // if it's already fine or some other provider
    } catch {
      return url;
    }
  }

  document.addEventListener("DOMContentLoaded", () => {
    const btnY = document.getElementById('switch-youtube');
    const btnV = document.getElementById('switch-virtual');

    function setMode(mode) {
      viewMode = mode;

      // Toggle button styles
      btnY.classList.toggle('bg-gray-900', mode === 'youtube');
      btnY.classList.toggle('text-white', mode === 'youtube');
      btnY.classList.toggle('text-gray-700', mode !== 'youtube');
      btnV.classList.toggle('bg-gray-900', mode === 'virtual');
      btnV.classList.toggle('text-white', mode === 'virtual');
      btnV.classList.toggle('text-gray-700', mode !== 'virtual');

      displayhealthcareCompanies();
    }

    btnY.addEventListener('click', () => setMode('youtube'));
    btnV.addEventListener('click', () => setMode('virtual'));

    // Initial render
    setMode('youtube');
  });

  function displayhealthcareCompanies() {
    const grid = document.getElementById("companies-grid");
    const loadingState = document.getElementById("loading-state");
    const noResults = document.getElementById("no-results");

    // Base dataset
    const raw = (Array.isArray(testimonialsData) ? testimonialsData : []).filter(c => c.myCategory === "healthcare");

    // Filter strictly by required media per mode
    const healthcareCompanies = (viewMode === 'virtual')
      ? raw.filter(c => !!getTourUrl(c))
      : raw.filter(c => !!getYouTubeUrl(c));

    // Hide loading spinner
    if (loadingState) loadingState.classList.add("hidden");

    if (healthcareCompanies.length === 0) {
      if (noResults) {
        noResults.classList.remove("hidden");
        const msg = noResults.querySelector('p');
        if (msg) {
          msg.textContent = (viewMode === 'virtual')
            ? "No virtual tours available."
            : "No YouTube videos available.";
        }
      }
      if (grid) grid.innerHTML = "";
      return;
    } else {
      if (noResults) noResults.classList.add("hidden");
    }

    grid.innerHTML = healthcareCompanies.map((company, index) => {
      const vtUrl = getTourUrl(company);
      const ytRaw = getYouTubeUrl(company);
      const ytEmbed = toYouTubeEmbed(ytRaw);
      const showYouTube = (viewMode === 'youtube');

      const mediaTitle = showYouTube ? 'Institution Video' : 'Virtual Tour';
      const mediaBlock = showYouTube
        ? `
          <iframe
            src="${ytEmbed}"
            class="w-full h-full"
            frameborder="0"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; fullscreen"
            allowfullscreen
            loading="lazy">
          </iframe>`
        : `
          <iframe
            src="${vtUrl}"
            class="w-full h-full"
            frameborder="0"
            allow="fullscreen; xr-spatial-tracking; accelerometer; gyroscope; magnetometer"
            allowfullscreen
            loading="lazy">
          </iframe>`;

      return `
        <div class="company-card bg-white rounded-xl shadow-lg hover:shadow-2xl p-6 border border-gray-100 fade-in-up" style="animation-delay: ${index * 0.1}s">
          <!-- Company Header -->
          <div class="flex items-start space-x-4 mb-4">
            <div class="w-16 h-16 rounded-lg bg-gradient-to-br from-green-500 to-green-700 flex items-center justify-center text-white font-bold text-lg">
              ${(company.name ? company.name.charAt(0) : 'E')}
            </div>
            <div class="flex-1">
              <h3 class="text-xl font-bold text-green-900 mb-1">${company.name || 'Institution'}</h3>
              <span class="inline-block px-3 py-1 bg-green-100 text-green-800 text-xs font-medium rounded-full">Healthcare</span>
            </div>
          </div>

          <!-- Media -->
          <div class="mb-4">
            <h4 class="text-sm font-semibold text-gray-700 mb-2">${mediaTitle}</h4>
            <div class="relative w-full h-48 rounded-lg overflow-hidden">
              ${mediaBlock}
            </div>
          </div>

          <!-- Action Buttons -->
          <div class="flex space-x-2">
            ${company.googleMapsPage ? `<a href="${company.googleMapsPage}" target="_blank" class="flex-1 bg-green-600 text-white px-3 py-2 rounded-lg text-sm font-medium hover:bg-green-700 transition-colors text-center">Google Maps</a>` : ''}
            ${company.google360 ? `<a href="${company.google360}" target="_blank" class="flex-1 bg-blue-600 text-white px-3 py-2 rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors text-center">360¬∞ View</a>` : ''}
          </div>
        </div>
      `;
    }).join("");

    // Staggered animation delays
    const cards = grid.querySelectorAll(".company-card");
    cards.forEach((card, index) => {
      card.style.animationDelay = `${index * 0.15}s`;
    });
  }
</script>

</body>
</html>
